c(1,3,5,7)-0.6,data1$cs_ciu_test[data1$norm==0 & data1$strat==1 & data1$combat==0 & data1$method==1],col="gray",lwd=2,lty=1)
# segments(c(1,3,5,7)-0.5,data1$cs_cil_test[data1$norm==0 & data1$strat==0 & data1$combat==1 & data1$method==1],
#          c(1,3,5,7)-0.5,data1$cs_ciu_test[data1$norm==0 & data1$strat==0 & data1$combat==1 & data1$method==1],col="gray",lwd=2,lty=1)
segments(c(1,3,5,7)-0.3,data1$cs_cil_test[data1$norm==1 & data1$strat==1 & data1$combat==0 & data1$method==1],
c(1,3,5,7)-0.3,data1$cs_ciu_test[data1$norm==1 & data1$strat==1 & data1$combat==0 & data1$method==1],col="gray",lwd=2,lty=1)
# segments(c(1,3,5,7)-0.2,data1$cs_cil_test[data1$norm==1 & data1$strat==0 & data1$combat==1 & data1$method==1],
#          c(1,3,5,7)-0.2,data1$cs_ciu_test[data1$norm==1 & data1$strat==0 & data1$combat==1 & data1$method==1],col="gray",lwd=2,lty=1)
segments(c(1,3,5,7)-0.1,data1$cs_cil_test[data1$norm==1 & data1$strat==0 & data1$combat==0 & data1$method==1],
c(1,3,5,7)-0.1,data1$cs_ciu_test[data1$norm==1 & data1$strat==0 & data1$combat==0 & data1$method==1],col="gray",lwd=2,lty=1)
segments(c(1,3,5,7),data1$cs_cil_test[data1$norm==2 & data1$strat==1 & data1$combat==0 & data1$method==1],
c(1,3,5,7),data1$cs_ciu_test[data1$norm==2 & data1$strat==1 & data1$combat==0 & data1$method==1],col="gray",lwd=2,lty=1)
# segments(c(1,3,5,7)+0.1,data1$cs_cil_test[data1$norm==2 & data1$strat==0 & data1$combat==1 & data1$method==1],
#          c(1,3,5,7)+0.1,data1$cs_ciu_test[data1$norm==2 & data1$strat==0 & data1$combat==1 & data1$method==1],col="gray",lwd=2,lty=1)
segments(c(1,3,5,7)+0.2,data1$cs_cil_test[data1$norm==2 & data1$strat==0 & data1$combat==0 & data1$method==1],
c(1,3,5,7)+0.2,data1$cs_ciu_test[data1$norm==2 & data1$strat==0 & data1$combat==0 & data1$method==1],col="gray",lwd=2,lty=1)
segments(c(1,3,5,7)+0.3,data1$cs_cil_test[data1$norm==3 & data1$strat==1 & data1$combat==0 & data1$method==1],
c(1,3,5,7)+0.3,data1$cs_ciu_test[data1$norm==3 & data1$strat==1 & data1$combat==0 & data1$method==1],col="gray",lwd=2,lty=1)
# segments(c(1,3,5,7)+0.4,data1$cs_cil_test[data1$norm==3 & data1$strat==0 & data1$combat==1 & data1$method==1],
#          c(1,3,5,7)+0.4,data1$cs_ciu_test[data1$norm==3 & data1$strat==0 & data1$combat==1 & data1$method==1],col="gray",lwd=2,lty=1)
segments(c(1,3,5,7)+0.5,data1$cs_cil_test[data1$norm==3 & data1$strat==0 & data1$combat==0 & data1$method==1],
c(1,3,5,7)+0.5,data1$cs_ciu_test[data1$norm==3 & data1$strat==0 & data1$combat==0 & data1$method==1],col="gray",lwd=2,lty=1)
segments(c(1,3,5,7)+0.6,data1$cs_cil_test[data1$norm==4 & data1$strat==1 & data1$combat==0 & data1$method==1],
c(1,3,5,7)+0.6,data1$cs_ciu_test[data1$norm==4 & data1$strat==1 & data1$combat==0 & data1$method==1],col="gray",lwd=2,lty=1)
# segments(c(1,3,5,7)+0.7,data1$cs_cil_test[data1$norm==4 & data1$strat==0 & data1$combat==1 & data1$method==1],
#          c(1,3,5,7)+0.7,data1$cs_ciu_test[data1$norm==4 & data1$strat==0 & data1$combat==1 & data1$method==1],col="gray",lwd=2,lty=1)
segments(c(1,3,5,7)+0.8,data1$cs_cil_test[data1$norm==4 & data1$strat==0 & data1$combat==0 & data1$method==1],
c(1,3,5,7)+0.8,data1$cs_ciu_test[data1$norm==4 & data1$strat==0 & data1$combat==0 & data1$method==1],col="gray",lwd=2,lty=1)
points(c(1,3,5,7)-0.4, data1$cs_test[data1$norm==0 & data1$strat==0 & data1$combat==0 & data1$method==1],lty=2,col="black",pch=1,cex=1.5)
points(c(1,3,5,7)-0.6, data1$cs_test[data1$norm==0 & data1$strat==1 & data1$combat==0 & data1$method==1],lty=2,col="black",pch=15,cex=1.5)
# points(c(1,3,5,7)-0.5, data1$cs_test[data1$norm==0 & data1$strat==0 & data1$combat==1 & data1$method==1],lty=2,col="black",pch=17,cex=1.5)
points(c(1,3,5,7)-0.3, data1$cs_test[data1$norm==1 & data1$strat==1 & data1$combat==0 & data1$method==1],lty=2,col="red",pch=15,cex=1.5)
# points(c(1,3,5,7)-0.2, data1$cs_test[data1$norm==1 & data1$strat==0 & data1$combat==1 & data1$method==1],lty=2,col="red",pch=17,cex=1.5)
points(c(1,3,5,7)-0.1, data1$cs_test[data1$norm==1 & data1$strat==0 & data1$combat==0 & data1$method==1],lty=2,col="red",pch=1,cex=1.5)
points(c(1,3,5,7), data1$cs_test[data1$norm==2 & data1$strat==1 & data1$combat==0 & data1$method==1],lty=2,col="green",pch=15,cex=1.5)
# points(c(1,3,5,7)+0.1, data1$cs_test[data1$norm==2 & data1$strat==0 & data1$combat==1 & data1$method==1],lty=2,col="green",pch=17,cex=1.5)
points(c(1,3,5,7)+0.2, data1$cs_test[data1$norm==2 & data1$strat==0 & data1$combat==0 & data1$method==1],lty=2,col="green",pch=1,cex=1.5)
points(c(1,3,5,7)+0.3, data1$cs_test[data1$norm==3 & data1$strat==1 & data1$combat==0 & data1$method==1],lty=2,col="blue",pch=15,cex=1.5)
# points(c(1,3,5,7)+0.4, data1$cs_test[data1$norm==3 & data1$strat==0 & data1$combat==1 & data1$method==1],lty=2,col="blue",pch=17,cex=1.5)
points(c(1,3,5,7)+0.5, data1$cs_test[data1$norm==3 & data1$strat==0 & data1$combat==0 & data1$method==1],lty=2,col="blue",pch=1,cex=1.5)
points(c(1,3,5,7)+0.6, data1$cs_test[data1$norm==4 & data1$strat==1 & data1$combat==0 & data1$method==1],lty=2,col="orange",pch=15,cex=1.5)
# points(c(1,3,5,7)+0.7, data1$cs_test[data1$norm==4 & data1$strat==0 & data1$combat==1 & data1$method==1],lty=2,col="orange",pch=17,cex=1.5)
points(c(1,3,5,7)+0.8, data1$cs_test[data1$norm==4 & data1$strat==0 & data1$combat==0 & data1$method==1],lty=2,col="orange",pch=1,cex=1.5)
axis(2)
axis(1,at=c(1,3,5,7),tick=F, labels=c("BE00Asso00", "BE10Asso00", "BE10Asso10", "BE11Asso00"), cex.axis=1.2)
box()
abline(v=c(2,4,6), lty=2)
abline(h=0.5, lty=2)
pdf("edgeRV2meanb_LB_oracle_bs20.pdf", width=14, height=14)
par(mar=c(3.1, 4.1, 2.1, 2.1), las=1)
par(mfrow=c(2,1))
plot(c(1,3,5,7)-0.4, data1$cs_test[data1$norm==0 & data1$strat==0 & data1$combat==0 & data1$method==1], type="p",ylim=c(0,1), xlim=c(0,8),
main="Oracle method", ylab="Test C-index",xlab="", col="black", pch=1, axes=F, cex=1.5, cex.lab=1.2,lty=1,cex.main=1.2)
segments(c(1,3,5,7)-0.4,data1$cs_cil_test[data1$norm==0 & data1$strat==0 & data1$combat==0 & data1$method==1],
c(1,3,5,7)-0.4,data1$cs_ciu_test[data1$norm==0 & data1$strat==0 & data1$combat==0 & data1$method==1],col="gray",lwd=2,lty=1)
segments(c(1,3,5,7)-0.6,data1$cs_cil_test[data1$norm==0 & data1$strat==1 & data1$combat==0 & data1$method==1],
c(1,3,5,7)-0.6,data1$cs_ciu_test[data1$norm==0 & data1$strat==1 & data1$combat==0 & data1$method==1],col="gray",lwd=2,lty=1)
# segments(c(1,3,5,7)-0.5,data1$cs_cil_test[data1$norm==0 & data1$strat==0 & data1$combat==1 & data1$method==1],
#          c(1,3,5,7)-0.5,data1$cs_ciu_test[data1$norm==0 & data1$strat==0 & data1$combat==1 & data1$method==1],col="gray",lwd=2,lty=1)
segments(c(1,3,5,7)-0.3,data1$cs_cil_test[data1$norm==1 & data1$strat==1 & data1$combat==0 & data1$method==1],
c(1,3,5,7)-0.3,data1$cs_ciu_test[data1$norm==1 & data1$strat==1 & data1$combat==0 & data1$method==1],col="gray",lwd=2,lty=1)
# segments(c(1,3,5,7)-0.2,data1$cs_cil_test[data1$norm==1 & data1$strat==0 & data1$combat==1 & data1$method==1],
#          c(1,3,5,7)-0.2,data1$cs_ciu_test[data1$norm==1 & data1$strat==0 & data1$combat==1 & data1$method==1],col="gray",lwd=2,lty=1)
segments(c(1,3,5,7)-0.1,data1$cs_cil_test[data1$norm==1 & data1$strat==0 & data1$combat==0 & data1$method==1],
c(1,3,5,7)-0.1,data1$cs_ciu_test[data1$norm==1 & data1$strat==0 & data1$combat==0 & data1$method==1],col="gray",lwd=2,lty=1)
segments(c(1,3,5,7),data1$cs_cil_test[data1$norm==2 & data1$strat==1 & data1$combat==0 & data1$method==1],
c(1,3,5,7),data1$cs_ciu_test[data1$norm==2 & data1$strat==1 & data1$combat==0 & data1$method==1],col="gray",lwd=2,lty=1)
# segments(c(1,3,5,7)+0.1,data1$cs_cil_test[data1$norm==2 & data1$strat==0 & data1$combat==1 & data1$method==1],
#          c(1,3,5,7)+0.1,data1$cs_ciu_test[data1$norm==2 & data1$strat==0 & data1$combat==1 & data1$method==1],col="gray",lwd=2,lty=1)
segments(c(1,3,5,7)+0.2,data1$cs_cil_test[data1$norm==2 & data1$strat==0 & data1$combat==0 & data1$method==1],
c(1,3,5,7)+0.2,data1$cs_ciu_test[data1$norm==2 & data1$strat==0 & data1$combat==0 & data1$method==1],col="gray",lwd=2,lty=1)
segments(c(1,3,5,7)+0.3,data1$cs_cil_test[data1$norm==3 & data1$strat==1 & data1$combat==0 & data1$method==1],
c(1,3,5,7)+0.3,data1$cs_ciu_test[data1$norm==3 & data1$strat==1 & data1$combat==0 & data1$method==1],col="gray",lwd=2,lty=1)
# segments(c(1,3,5,7)+0.4,data1$cs_cil_test[data1$norm==3 & data1$strat==0 & data1$combat==1 & data1$method==1],
#          c(1,3,5,7)+0.4,data1$cs_ciu_test[data1$norm==3 & data1$strat==0 & data1$combat==1 & data1$method==1],col="gray",lwd=2,lty=1)
segments(c(1,3,5,7)+0.5,data1$cs_cil_test[data1$norm==3 & data1$strat==0 & data1$combat==0 & data1$method==1],
c(1,3,5,7)+0.5,data1$cs_ciu_test[data1$norm==3 & data1$strat==0 & data1$combat==0 & data1$method==1],col="gray",lwd=2,lty=1)
segments(c(1,3,5,7)+0.6,data1$cs_cil_test[data1$norm==4 & data1$strat==1 & data1$combat==0 & data1$method==1],
c(1,3,5,7)+0.6,data1$cs_ciu_test[data1$norm==4 & data1$strat==1 & data1$combat==0 & data1$method==1],col="gray",lwd=2,lty=1)
# segments(c(1,3,5,7)+0.7,data1$cs_cil_test[data1$norm==4 & data1$strat==0 & data1$combat==1 & data1$method==1],
#          c(1,3,5,7)+0.7,data1$cs_ciu_test[data1$norm==4 & data1$strat==0 & data1$combat==1 & data1$method==1],col="gray",lwd=2,lty=1)
segments(c(1,3,5,7)+0.8,data1$cs_cil_test[data1$norm==4 & data1$strat==0 & data1$combat==0 & data1$method==1],
c(1,3,5,7)+0.8,data1$cs_ciu_test[data1$norm==4 & data1$strat==0 & data1$combat==0 & data1$method==1],col="gray",lwd=2,lty=1)
points(c(1,3,5,7)-0.4, data1$cs_test[data1$norm==0 & data1$strat==0 & data1$combat==0 & data1$method==1],lty=2,col="black",pch=1,cex=1.5)
points(c(1,3,5,7)-0.6, data1$cs_test[data1$norm==0 & data1$strat==1 & data1$combat==0 & data1$method==1],lty=2,col="black",pch=15,cex=1.5)
# points(c(1,3,5,7)-0.5, data1$cs_test[data1$norm==0 & data1$strat==0 & data1$combat==1 & data1$method==1],lty=2,col="black",pch=17,cex=1.5)
points(c(1,3,5,7)-0.3, data1$cs_test[data1$norm==1 & data1$strat==1 & data1$combat==0 & data1$method==1],lty=2,col="red",pch=15,cex=1.5)
# points(c(1,3,5,7)-0.2, data1$cs_test[data1$norm==1 & data1$strat==0 & data1$combat==1 & data1$method==1],lty=2,col="red",pch=17,cex=1.5)
points(c(1,3,5,7)-0.1, data1$cs_test[data1$norm==1 & data1$strat==0 & data1$combat==0 & data1$method==1],lty=2,col="red",pch=1,cex=1.5)
points(c(1,3,5,7), data1$cs_test[data1$norm==2 & data1$strat==1 & data1$combat==0 & data1$method==1],lty=2,col="green",pch=15,cex=1.5)
# points(c(1,3,5,7)+0.1, data1$cs_test[data1$norm==2 & data1$strat==0 & data1$combat==1 & data1$method==1],lty=2,col="green",pch=17,cex=1.5)
points(c(1,3,5,7)+0.2, data1$cs_test[data1$norm==2 & data1$strat==0 & data1$combat==0 & data1$method==1],lty=2,col="green",pch=1,cex=1.5)
points(c(1,3,5,7)+0.3, data1$cs_test[data1$norm==3 & data1$strat==1 & data1$combat==0 & data1$method==1],lty=2,col="blue",pch=15,cex=1.5)
# points(c(1,3,5,7)+0.4, data1$cs_test[data1$norm==3 & data1$strat==0 & data1$combat==1 & data1$method==1],lty=2,col="blue",pch=17,cex=1.5)
points(c(1,3,5,7)+0.5, data1$cs_test[data1$norm==3 & data1$strat==0 & data1$combat==0 & data1$method==1],lty=2,col="blue",pch=1,cex=1.5)
points(c(1,3,5,7)+0.6, data1$cs_test[data1$norm==4 & data1$strat==1 & data1$combat==0 & data1$method==1],lty=2,col="orange",pch=15,cex=1.5)
# points(c(1,3,5,7)+0.7, data1$cs_test[data1$norm==4 & data1$strat==0 & data1$combat==1 & data1$method==1],lty=2,col="orange",pch=17,cex=1.5)
points(c(1,3,5,7)+0.8, data1$cs_test[data1$norm==4 & data1$strat==0 & data1$combat==0 & data1$method==1],lty=2,col="orange",pch=1,cex=1.5)
axis(2)
axis(1,at=c(1,3,5,7),tick=F, labels=c("BE00Asso00", "BE10Asso00", "BE10Asso10", "BE11Asso00"), cex.axis=1.2)
box()
abline(v=c(2,4,6), lty=2)
abline(h=0.5, lty=2)
# dev.off()
plot(c(1,3,5,7)-0.4, data2$cs_test[data2$norm==0 & data2$strat==0 & data2$combat==0 & data2$method==1], type="p",ylim=c(0,1), xlim=c(0,8),
main="Oracle method", ylab="Test C-index",xlab="", col="black", pch=1, axes=F, cex=1.5, cex.lab=1.2,lty=1,cex.main=1.2)
segments(c(1,3,5,7)-0.4,data2$cs_cil_test[data2$norm==0 & data2$strat==0 & data2$combat==0 & data2$method==1],
c(1,3,5,7)-0.4,data2$cs_ciu_test[data2$norm==0 & data2$strat==0 & data2$combat==0 & data2$method==1],col="gray",lwd=2,lty=1)
segments(c(1,3,5,7)-0.6,data2$cs_cil_test[data2$norm==0 & data2$strat==1 & data2$combat==0 & data2$method==1],
c(1,3,5,7)-0.6,data2$cs_ciu_test[data2$norm==0 & data2$strat==1 & data2$combat==0 & data2$method==1],col="gray",lwd=2,lty=1)
segments(c(1,3,5,7)-0.5,data2$cs_cil_test[data2$norm==0 & data2$strat==0 & data2$combat==1 & data2$method==1],
c(1,3,5,7)-0.5,data2$cs_ciu_test[data2$norm==0 & data2$strat==0 & data2$combat==1 & data2$method==1],col="gray",lwd=2,lty=1)
segments(c(1,3,5,7)-0.3,data2$cs_cil_test[data2$norm==1 & data2$strat==1 & data2$combat==0 & data2$method==1],
c(1,3,5,7)-0.3,data2$cs_ciu_test[data2$norm==1 & data2$strat==1 & data2$combat==0 & data2$method==1],col="gray",lwd=2,lty=1)
segments(c(1,3,5,7)-0.2,data2$cs_cil_test[data2$norm==1 & data2$strat==0 & data2$combat==1 & data2$method==1],
c(1,3,5,7)-0.2,data2$cs_ciu_test[data2$norm==1 & data2$strat==0 & data2$combat==1 & data2$method==1],col="gray",lwd=2,lty=1)
segments(c(1,3,5,7)-0.1,data2$cs_cil_test[data2$norm==1 & data2$strat==0 & data2$combat==0 & data2$method==1],
c(1,3,5,7)-0.1,data2$cs_ciu_test[data2$norm==1 & data2$strat==0 & data2$combat==0 & data2$method==1],col="gray",lwd=2,lty=1)
segments(c(1,3,5,7),data2$cs_cil_test[data2$norm==2 & data2$strat==1 & data2$combat==0 & data2$method==1],
c(1,3,5,7),data2$cs_ciu_test[data2$norm==2 & data2$strat==1 & data2$combat==0 & data2$method==1],col="gray",lwd=2,lty=1)
segments(c(1,3,5,7)+0.1,data2$cs_cil_test[data2$norm==2 & data2$strat==0 & data2$combat==1 & data2$method==1],
c(1,3,5,7)+0.1,data2$cs_ciu_test[data2$norm==2 & data2$strat==0 & data2$combat==1 & data2$method==1],col="gray",lwd=2,lty=1)
segments(c(1,3,5,7)+0.2,data2$cs_cil_test[data2$norm==2 & data2$strat==0 & data2$combat==0 & data2$method==1],
c(1,3,5,7)+0.2,data2$cs_ciu_test[data2$norm==2 & data2$strat==0 & data2$combat==0 & data2$method==1],col="gray",lwd=2,lty=1)
segments(c(1,3,5,7)+0.3,data2$cs_cil_test[data2$norm==3 & data2$strat==1 & data2$combat==0 & data2$method==1],
c(1,3,5,7)+0.3,data2$cs_ciu_test[data2$norm==3 & data2$strat==1 & data2$combat==0 & data2$method==1],col="gray",lwd=2,lty=1)
segments(c(1,3,5,7)+0.4,data2$cs_cil_test[data2$norm==3 & data2$strat==0 & data2$combat==1 & data2$method==1],
c(1,3,5,7)+0.4,data2$cs_ciu_test[data2$norm==3 & data2$strat==0 & data2$combat==1 & data2$method==1],col="gray",lwd=2,lty=1)
segments(c(1,3,5,7)+0.5,data2$cs_cil_test[data2$norm==3 & data2$strat==0 & data2$combat==0 & data2$method==1],
c(1,3,5,7)+0.5,data2$cs_ciu_test[data2$norm==3 & data2$strat==0 & data2$combat==0 & data2$method==1],col="gray",lwd=2,lty=1)
segments(c(1,3,5,7)+0.6,data2$cs_cil_test[data2$norm==4 & data2$strat==1 & data2$combat==0 & data2$method==1],
c(1,3,5,7)+0.6,data2$cs_ciu_test[data2$norm==4 & data2$strat==1 & data2$combat==0 & data2$method==1],col="gray",lwd=2,lty=1)
segments(c(1,3,5,7)+0.7,data2$cs_cil_test[data2$norm==4 & data2$strat==0 & data2$combat==1 & data2$method==1],
c(1,3,5,7)+0.7,data2$cs_ciu_test[data2$norm==4 & data2$strat==0 & data2$combat==1 & data2$method==1],col="gray",lwd=2,lty=1)
segments(c(1,3,5,7)+0.8,data2$cs_cil_test[data2$norm==4 & data2$strat==0 & data2$combat==0 & data2$method==1],
c(1,3,5,7)+0.8,data2$cs_ciu_test[data2$norm==4 & data2$strat==0 & data2$combat==0 & data2$method==1],col="gray",lwd=2,lty=1)
points(c(1,3,5,7)-0.4, data2$cs_test[data2$norm==0 & data2$strat==0 & data2$combat==0 & data2$method==1],lty=2,col="black",pch=1,cex=1.5)
points(c(1,3,5,7)-0.6, data2$cs_test[data2$norm==0 & data2$strat==1 & data2$combat==0 & data2$method==1],lty=2,col="black",pch=15,cex=1.5)
points(c(1,3,5,7)-0.5, data2$cs_test[data2$norm==0 & data2$strat==0 & data2$combat==1 & data2$method==1],lty=2,col="black",pch=17,cex=1.5)
points(c(1,3,5,7)-0.3, data2$cs_test[data2$norm==1 & data2$strat==1 & data2$combat==0 & data2$method==1],lty=2,col="red",pch=15,cex=1.5)
points(c(1,3,5,7)-0.2, data2$cs_test[data2$norm==1 & data2$strat==0 & data2$combat==1 & data2$method==1],lty=2,col="red",pch=17,cex=1.5)
points(c(1,3,5,7)-0.1, data2$cs_test[data2$norm==1 & data2$strat==0 & data2$combat==0 & data2$method==1],lty=2,col="red",pch=1,cex=1.5)
points(c(1,3,5,7), data2$cs_test[data2$norm==2 & data2$strat==1 & data2$combat==0 & data2$method==1],lty=2,col="green",pch=15,cex=1.5)
points(c(1,3,5,7)+0.1, data2$cs_test[data2$norm==2 & data2$strat==0 & data2$combat==1 & data2$method==1],lty=2,col="green",pch=17,cex=1.5)
points(c(1,3,5,7)+0.2, data2$cs_test[data2$norm==2 & data2$strat==0 & data2$combat==0 & data2$method==1],lty=2,col="green",pch=1,cex=1.5)
points(c(1,3,5,7)+0.3, data2$cs_test[data2$norm==3 & data2$strat==1 & data2$combat==0 & data2$method==1],lty=2,col="blue",pch=15,cex=1.5)
points(c(1,3,5,7)+0.4, data2$cs_test[data2$norm==3 & data2$strat==0 & data2$combat==1 & data2$method==1],lty=2,col="blue",pch=17,cex=1.5)
points(c(1,3,5,7)+0.5, data2$cs_test[data2$norm==3 & data2$strat==0 & data2$combat==0 & data2$method==1],lty=2,col="blue",pch=1,cex=1.5)
points(c(1,3,5,7)+0.6, data2$cs_test[data2$norm==4 & data2$strat==1 & data2$combat==0 & data2$method==1],lty=2,col="orange",pch=15,cex=1.5)
points(c(1,3,5,7)+0.7, data2$cs_test[data2$norm==4 & data2$strat==0 & data2$combat==1 & data2$method==1],lty=2,col="orange",pch=17,cex=1.5)
points(c(1,3,5,7)+0.8, data2$cs_test[data2$norm==4 & data2$strat==0 & data2$combat==0 & data2$method==1],lty=2,col="orange",pch=1,cex=1.5)
axis(2)
axis(1,at=c(1,3,5,7),tick=F, labels=c("BE11Asso10", "BE11Asso01", "BE11Asso11", "BE11Asso1-1"), cex.axis=1.2)
box()
abline(v=c(2,4,6), lty=2)
abline(h=0.5, lty=2)
legend2("bottomleft",bty="n",lty=1,lwd=2,pch=c(1,15,17,1,1,1), pt.bg="black", col=c(rep("black",each=3), "red","green","blue","orange"),
legend=c("None","X+BatMan","X+ComBat","TC","UQ","TMM","QN"),cex=1.2,
pt.col=c(rep("black",each=3), "red","green","blue","orange"),line.col="grey")
text(1.1,0.1,"black: X=no norm;",pos=4,cex=1.2)
text(2.5,0.1,"red: X=TC;",pos=4,cex=1.2,col="red")
text(3.5,0.1,"green: X=UQ;",pos=4,cex=1.2,col="green")
text(5.0,0.1,"blue: X=TMM",pos=4,cex=1.2,col="blue")
text(6.5,0.1,"blue: X=QN",pos=4,cex=1.2,col="orange")
dev.off()
pdf("edgeRV2meanb_LB_univ_bs20.pdf", width=14, height=14)
par(mar=c(3.1, 4.1, 2.1, 2.1), las=1)
par(mfrow=c(2,1))
plot(c(1,3,5,7)-0.4, data1$cs_test[data1$norm==0 & data1$strat==0 & data1$combat==0 & data1$method==2], type="p",ylim=c(0,1), xlim=c(0,8),
main="Univariate method", ylab="Test C-index",xlab="", col="black", pch=1, axes=F, cex=1.5, cex.lab=1.2,lty=1,cex.main=1.2)
segments(c(1,3,5,7)-0.4,data1$cs_cil_test[data1$norm==0 & data1$strat==0 & data1$combat==0 & data1$method==2],
c(1,3,5,7)-0.4,data1$cs_ciu_test[data1$norm==0 & data1$strat==0 & data1$combat==0 & data1$method==2],col="gray",lwd=2,lty=1)
segments(c(1,3,5,7)-0.6,data1$cs_cil_test[data1$norm==0 & data1$strat==1 & data1$combat==0 & data1$method==2],
c(1,3,5,7)-0.6,data1$cs_ciu_test[data1$norm==0 & data1$strat==1 & data1$combat==0 & data1$method==2],col="gray",lwd=2,lty=1)
# segments(c(1,3,5,7)-0.5,data1$cs_cil_test[data1$norm==0 & data1$strat==0 & data1$combat==1 & data1$method==2],
#          c(1,3,5,7)-0.5,data1$cs_ciu_test[data1$norm==0 & data1$strat==0 & data1$combat==1 & data1$method==2],col="gray",lwd=2,lty=1)
segments(c(1,3,5,7)-0.3,data1$cs_cil_test[data1$norm==1 & data1$strat==1 & data1$combat==0 & data1$method==2],
c(1,3,5,7)-0.3,data1$cs_ciu_test[data1$norm==1 & data1$strat==1 & data1$combat==0 & data1$method==2],col="gray",lwd=2,lty=1)
# segments(c(1,3,5,7)-0.2,data1$cs_cil_test[data1$norm==1 & data1$strat==0 & data1$combat==1 & data1$method==2],
#          c(1,3,5,7)-0.2,data1$cs_ciu_test[data1$norm==1 & data1$strat==0 & data1$combat==1 & data1$method==2],col="gray",lwd=2,lty=1)
segments(c(1,3,5,7)-0.1,data1$cs_cil_test[data1$norm==1 & data1$strat==0 & data1$combat==0 & data1$method==2],
c(1,3,5,7)-0.1,data1$cs_ciu_test[data1$norm==1 & data1$strat==0 & data1$combat==0 & data1$method==2],col="gray",lwd=2,lty=1)
segments(c(1,3,5,7),data1$cs_cil_test[data1$norm==2 & data1$strat==1 & data1$combat==0 & data1$method==2],
c(1,3,5,7),data1$cs_ciu_test[data1$norm==2 & data1$strat==1 & data1$combat==0 & data1$method==2],col="gray",lwd=2,lty=1)
# segments(c(1,3,5,7)+0.1,data1$cs_cil_test[data1$norm==2 & data1$strat==0 & data1$combat==1 & data1$method==2],
#          c(1,3,5,7)+0.1,data1$cs_ciu_test[data1$norm==2 & data1$strat==0 & data1$combat==1 & data1$method==2],col="gray",lwd=2,lty=1)
segments(c(1,3,5,7)+0.2,data1$cs_cil_test[data1$norm==2 & data1$strat==0 & data1$combat==0 & data1$method==2],
c(1,3,5,7)+0.2,data1$cs_ciu_test[data1$norm==2 & data1$strat==0 & data1$combat==0 & data1$method==2],col="gray",lwd=2,lty=1)
segments(c(1,3,5,7)+0.3,data1$cs_cil_test[data1$norm==3 & data1$strat==1 & data1$combat==0 & data1$method==2],
c(1,3,5,7)+0.3,data1$cs_ciu_test[data1$norm==3 & data1$strat==1 & data1$combat==0 & data1$method==2],col="gray",lwd=2,lty=1)
# segments(c(1,3,5,7)+0.4,data1$cs_cil_test[data1$norm==3 & data1$strat==0 & data1$combat==1 & data1$method==2],
#          c(1,3,5,7)+0.4,data1$cs_ciu_test[data1$norm==3 & data1$strat==0 & data1$combat==1 & data1$method==2],col="gray",lwd=2,lty=1)
segments(c(1,3,5,7)+0.5,data1$cs_cil_test[data1$norm==3 & data1$strat==0 & data1$combat==0 & data1$method==2],
c(1,3,5,7)+0.5,data1$cs_ciu_test[data1$norm==3 & data1$strat==0 & data1$combat==0 & data1$method==2],col="gray",lwd=2,lty=1)
segments(c(1,3,5,7)+0.6,data1$cs_cil_test[data1$norm==4 & data1$strat==1 & data1$combat==0 & data1$method==2],
c(1,3,5,7)+0.6,data1$cs_ciu_test[data1$norm==4 & data1$strat==1 & data1$combat==0 & data1$method==2],col="gray",lwd=2,lty=1)
# segments(c(1,3,5,7)+0.7,data1$cs_cil_test[data1$norm==4 & data1$strat==0 & data1$combat==1 & data1$method==2],
#          c(1,3,5,7)+0.7,data1$cs_ciu_test[data1$norm==4 & data1$strat==0 & data1$combat==1 & data1$method==2],col="gray",lwd=2,lty=1)
segments(c(1,3,5,7)+0.8,data1$cs_cil_test[data1$norm==4 & data1$strat==0 & data1$combat==0 & data1$method==2],
c(1,3,5,7)+0.8,data1$cs_ciu_test[data1$norm==4 & data1$strat==0 & data1$combat==0 & data1$method==2],col="gray",lwd=2,lty=1)
points(c(1,3,5,7)-0.4, data1$cs_test[data1$norm==0 & data1$strat==0 & data1$combat==0 & data1$method==2],lty=2,col="black",pch=1,cex=1.5)
points(c(1,3,5,7)-0.6, data1$cs_test[data1$norm==0 & data1$strat==1 & data1$combat==0 & data1$method==2],lty=2,col="black",pch=15,cex=1.5)
# points(c(1,3,5,7)-0.5, data1$cs_test[data1$norm==0 & data1$strat==0 & data1$combat==1 & data1$method==2],lty=2,col="black",pch=17,cex=1.5)
points(c(1,3,5,7)-0.3, data1$cs_test[data1$norm==1 & data1$strat==1 & data1$combat==0 & data1$method==2],lty=2,col="red",pch=15,cex=1.5)
# points(c(1,3,5,7)-0.2, data1$cs_test[data1$norm==1 & data1$strat==0 & data1$combat==1 & data1$method==2],lty=2,col="red",pch=17,cex=1.5)
points(c(1,3,5,7)-0.1, data1$cs_test[data1$norm==1 & data1$strat==0 & data1$combat==0 & data1$method==2],lty=2,col="red",pch=1,cex=1.5)
points(c(1,3,5,7), data1$cs_test[data1$norm==2 & data1$strat==1 & data1$combat==0 & data1$method==2],lty=2,col="green",pch=15,cex=1.5)
# points(c(1,3,5,7)+0.1, data1$cs_test[data1$norm==2 & data1$strat==0 & data1$combat==1 & data1$method==2],lty=2,col="green",pch=17,cex=1.5)
points(c(1,3,5,7)+0.2, data1$cs_test[data1$norm==2 & data1$strat==0 & data1$combat==0 & data1$method==2],lty=2,col="green",pch=1,cex=1.5)
points(c(1,3,5,7)+0.3, data1$cs_test[data1$norm==3 & data1$strat==1 & data1$combat==0 & data1$method==2],lty=2,col="blue",pch=15,cex=1.5)
# points(c(1,3,5,7)+0.4, data1$cs_test[data1$norm==3 & data1$strat==0 & data1$combat==1 & data1$method==2],lty=2,col="blue",pch=17,cex=1.5)
points(c(1,3,5,7)+0.5, data1$cs_test[data1$norm==3 & data1$strat==0 & data1$combat==0 & data1$method==2],lty=2,col="blue",pch=1,cex=1.5)
points(c(1,3,5,7)+0.6, data1$cs_test[data1$norm==4 & data1$strat==1 & data1$combat==0 & data1$method==2],lty=2,col="orange",pch=15,cex=1.5)
# points(c(1,3,5,7)+0.7, data1$cs_test[data1$norm==4 & data1$strat==0 & data1$combat==1 & data1$method==2],lty=2,col="orange",pch=17,cex=1.5)
points(c(1,3,5,7)+0.8, data1$cs_test[data1$norm==4 & data1$strat==0 & data1$combat==0 & data1$method==2],lty=2,col="orange",pch=1,cex=1.5)
axis(2)
axis(1,at=c(1,3,5,7),tick=F, labels=c("BE00Asso00", "BE10Asso00", "BE10Asso10", "BE11Asso00"), cex.axis=1.2)
box()
abline(v=c(2,4,6), lty=2)
abline(h=0.5, lty=2)
plot(c(1,3,5,7)-0.4, data2$cs_test[data2$norm==0 & data2$strat==0 & data2$combat==0 & data2$method==2], type="p",ylim=c(0,1), xlim=c(0,8),
main="Univariate method", ylab="Test C-index",xlab="", col="black", pch=1, axes=F, cex=1.5, cex.lab=1.2,lty=1,cex.main=1.2)
segments(c(1,3,5,7)-0.4,data2$cs_cil_test[data2$norm==0 & data2$strat==0 & data2$combat==0 & data2$method==2],
c(1,3,5,7)-0.4,data2$cs_ciu_test[data2$norm==0 & data2$strat==0 & data2$combat==0 & data2$method==2],col="gray",lwd=2,lty=1)
segments(c(1,3,5,7)-0.6,data2$cs_cil_test[data2$norm==0 & data2$strat==1 & data2$combat==0 & data2$method==2],
c(1,3,5,7)-0.6,data2$cs_ciu_test[data2$norm==0 & data2$strat==1 & data2$combat==0 & data2$method==2],col="gray",lwd=2,lty=1)
segments(c(1,3,5,7)-0.5,data2$cs_cil_test[data2$norm==0 & data2$strat==0 & data2$combat==1 & data2$method==2],
c(1,3,5,7)-0.5,data2$cs_ciu_test[data2$norm==0 & data2$strat==0 & data2$combat==1 & data2$method==2],col="gray",lwd=2,lty=1)
segments(c(1,3,5,7)-0.3,data2$cs_cil_test[data2$norm==1 & data2$strat==1 & data2$combat==0 & data2$method==2],
c(1,3,5,7)-0.3,data2$cs_ciu_test[data2$norm==1 & data2$strat==1 & data2$combat==0 & data2$method==2],col="gray",lwd=2,lty=1)
segments(c(1,3,5,7)-0.2,data2$cs_cil_test[data2$norm==1 & data2$strat==0 & data2$combat==1 & data2$method==2],
c(1,3,5,7)-0.2,data2$cs_ciu_test[data2$norm==1 & data2$strat==0 & data2$combat==1 & data2$method==2],col="gray",lwd=2,lty=1)
segments(c(1,3,5,7)-0.1,data2$cs_cil_test[data2$norm==1 & data2$strat==0 & data2$combat==0 & data2$method==2],
c(1,3,5,7)-0.1,data2$cs_ciu_test[data2$norm==1 & data2$strat==0 & data2$combat==0 & data2$method==2],col="gray",lwd=2,lty=1)
segments(c(1,3,5,7),data2$cs_cil_test[data2$norm==2 & data2$strat==1 & data2$combat==0 & data2$method==2],
c(1,3,5,7),data2$cs_ciu_test[data2$norm==2 & data2$strat==1 & data2$combat==0 & data2$method==2],col="gray",lwd=2,lty=1)
segments(c(1,3,5,7)+0.1,data2$cs_cil_test[data2$norm==2 & data2$strat==0 & data2$combat==1 & data2$method==2],
c(1,3,5,7)+0.1,data2$cs_ciu_test[data2$norm==2 & data2$strat==0 & data2$combat==1 & data2$method==2],col="gray",lwd=2,lty=1)
segments(c(1,3,5,7)+0.2,data2$cs_cil_test[data2$norm==2 & data2$strat==0 & data2$combat==0 & data2$method==2],
c(1,3,5,7)+0.2,data2$cs_ciu_test[data2$norm==2 & data2$strat==0 & data2$combat==0 & data2$method==2],col="gray",lwd=2,lty=1)
segments(c(1,3,5,7)+0.3,data2$cs_cil_test[data2$norm==3 & data2$strat==1 & data2$combat==0 & data2$method==2],
c(1,3,5,7)+0.3,data2$cs_ciu_test[data2$norm==3 & data2$strat==1 & data2$combat==0 & data2$method==2],col="gray",lwd=2,lty=1)
segments(c(1,3,5,7)+0.4,data2$cs_cil_test[data2$norm==3 & data2$strat==0 & data2$combat==1 & data2$method==2],
c(1,3,5,7)+0.4,data2$cs_ciu_test[data2$norm==3 & data2$strat==0 & data2$combat==1 & data2$method==2],col="gray",lwd=2,lty=1)
segments(c(1,3,5,7)+0.5,data2$cs_cil_test[data2$norm==3 & data2$strat==0 & data2$combat==0 & data2$method==2],
c(1,3,5,7)+0.5,data2$cs_ciu_test[data2$norm==3 & data2$strat==0 & data2$combat==0 & data2$method==2],col="gray",lwd=2,lty=1)
segments(c(1,3,5,7)+0.6,data2$cs_cil_test[data2$norm==4 & data2$strat==1 & data2$combat==0 & data2$method==2],
c(1,3,5,7)+0.6,data2$cs_ciu_test[data2$norm==4 & data2$strat==1 & data2$combat==0 & data2$method==2],col="gray",lwd=2,lty=1)
segments(c(1,3,5,7)+0.7,data2$cs_cil_test[data2$norm==4 & data2$strat==0 & data2$combat==1 & data2$method==2],
c(1,3,5,7)+0.7,data2$cs_ciu_test[data2$norm==4 & data2$strat==0 & data2$combat==1 & data2$method==2],col="gray",lwd=2,lty=1)
segments(c(1,3,5,7)+0.8,data2$cs_cil_test[data2$norm==4 & data2$strat==0 & data2$combat==0 & data2$method==2],
c(1,3,5,7)+0.8,data2$cs_ciu_test[data2$norm==4 & data2$strat==0 & data2$combat==0 & data2$method==2],col="gray",lwd=2,lty=1)
points(c(1,3,5,7)-0.4, data2$cs_test[data2$norm==0 & data2$strat==0 & data2$combat==0 & data2$method==2],lty=2,col="black",pch=1,cex=1.5)
points(c(1,3,5,7)-0.6, data2$cs_test[data2$norm==0 & data2$strat==1 & data2$combat==0 & data2$method==2],lty=2,col="black",pch=15,cex=1.5)
points(c(1,3,5,7)-0.5, data2$cs_test[data2$norm==0 & data2$strat==0 & data2$combat==1 & data2$method==2],lty=2,col="black",pch=17,cex=1.5)
points(c(1,3,5,7)-0.3, data2$cs_test[data2$norm==1 & data2$strat==1 & data2$combat==0 & data2$method==2],lty=2,col="red",pch=15,cex=1.5)
points(c(1,3,5,7)-0.2, data2$cs_test[data2$norm==1 & data2$strat==0 & data2$combat==1 & data2$method==2],lty=2,col="red",pch=17,cex=1.5)
points(c(1,3,5,7)-0.1, data2$cs_test[data2$norm==1 & data2$strat==0 & data2$combat==0 & data2$method==2],lty=2,col="red",pch=1,cex=1.5)
points(c(1,3,5,7), data2$cs_test[data2$norm==2 & data2$strat==1 & data2$combat==0 & data2$method==2],lty=2,col="green",pch=15,cex=1.5)
points(c(1,3,5,7)+0.1, data2$cs_test[data2$norm==2 & data2$strat==0 & data2$combat==1 & data2$method==2],lty=2,col="green",pch=17,cex=1.5)
points(c(1,3,5,7)+0.2, data2$cs_test[data2$norm==2 & data2$strat==0 & data2$combat==0 & data2$method==2],lty=2,col="green",pch=1,cex=1.5)
points(c(1,3,5,7)+0.3, data2$cs_test[data2$norm==3 & data2$strat==1 & data2$combat==0 & data2$method==2],lty=2,col="blue",pch=15,cex=1.5)
points(c(1,3,5,7)+0.4, data2$cs_test[data2$norm==3 & data2$strat==0 & data2$combat==1 & data2$method==2],lty=2,col="blue",pch=17,cex=1.5)
points(c(1,3,5,7)+0.5, data2$cs_test[data2$norm==3 & data2$strat==0 & data2$combat==0 & data2$method==2],lty=2,col="blue",pch=1,cex=1.5)
points(c(1,3,5,7)+0.6, data2$cs_test[data2$norm==4 & data2$strat==1 & data2$combat==0 & data2$method==2],lty=2,col="orange",pch=15,cex=1.5)
points(c(1,3,5,7)+0.7, data2$cs_test[data2$norm==4 & data2$strat==0 & data2$combat==1 & data2$method==2],lty=2,col="orange",pch=17,cex=1.5)
points(c(1,3,5,7)+0.8, data2$cs_test[data2$norm==4 & data2$strat==0 & data2$combat==0 & data2$method==2],lty=2,col="orange",pch=1,cex=1.5)
axis(2)
axis(1,at=c(1,3,5,7),tick=F, labels=c("BE11Asso10", "BE11Asso01", "BE11Asso11", "BE11Asso1-1"), cex.axis=1.2)
box()
abline(v=c(2,4,6), lty=2)
abline(h=0.5, lty=2)
legend2("bottomleft",bty="n",lty=1,lwd=2,pch=c(1,15,17,1,1,1), pt.bg="black", col=c(rep("black",each=3), "red","green","blue","orange"),
legend=c("None","X+BatMan","X+ComBat","TC","UQ","TMM","QN"),cex=1.2,
pt.col=c(rep("black",each=3), "red","green","blue","orange"),line.col="grey")
text(1.1,0.1,"black: X=no norm;",pos=4,cex=1.2)
text(2.5,0.1,"red: X=TC;",pos=4,cex=1.2,col="red")
text(3.5,0.1,"green: X=UQ;",pos=4,cex=1.2,col="green")
text(5.0,0.1,"blue: X=TMM",pos=4,cex=1.2,col="blue")
text(6.5,0.1,"blue: X=QN",pos=4,cex=1.2,col="orange")
dev.off()
pdf("edgeRV2meanb_LB_lasso_bs20.pdf", width=14, height=14)
par(mar=c(3.1, 4.1, 2.1, 2.1), las=1)
par(mfrow=c(2,1))
plot(c(1,3,5,7)-0.4, data1$cs_test[data1$norm==0 & data1$strat==0 & data1$combat==0 & data1$method==3], type="p",ylim=c(0,1), xlim=c(0,8),
main="Lasso method", ylab="Test C-index",xlab="", col="black", pch=1, axes=F, cex=1.5, cex.lab=1.2,lty=1,cex.main=1.2)
segments(c(1,3,5,7)-0.4,data1$cs_cil_test[data1$norm==0 & data1$strat==0 & data1$combat==0 & data1$method==3],
c(1,3,5,7)-0.4,data1$cs_ciu_test[data1$norm==0 & data1$strat==0 & data1$combat==0 & data1$method==3],col="gray",lwd=2,lty=1)
segments(c(1,3,5,7)-0.6,data1$cs_cil_test[data1$norm==0 & data1$strat==1 & data1$combat==0 & data1$method==3],
c(1,3,5,7)-0.6,data1$cs_ciu_test[data1$norm==0 & data1$strat==1 & data1$combat==0 & data1$method==3],col="gray",lwd=2,lty=1)
# segments(c(1,3,5,7)-0.5,data1$cs_cil_test[data1$norm==0 & data1$strat==0 & data1$combat==1 & data1$method==3],
#          c(1,3,5,7)-0.5,data1$cs_ciu_test[data1$norm==0 & data1$strat==0 & data1$combat==1 & data1$method==3],col="gray",lwd=2,lty=1)
segments(c(1,3,5,7)-0.3,data1$cs_cil_test[data1$norm==1 & data1$strat==1 & data1$combat==0 & data1$method==3],
c(1,3,5,7)-0.3,data1$cs_ciu_test[data1$norm==1 & data1$strat==1 & data1$combat==0 & data1$method==3],col="gray",lwd=2,lty=1)
# segments(c(1,3,5,7)-0.2,data1$cs_cil_test[data1$norm==1 & data1$strat==0 & data1$combat==1 & data1$method==3],
#          c(1,3,5,7)-0.2,data1$cs_ciu_test[data1$norm==1 & data1$strat==0 & data1$combat==1 & data1$method==3],col="gray",lwd=2,lty=1)
segments(c(1,3,5,7)-0.1,data1$cs_cil_test[data1$norm==1 & data1$strat==0 & data1$combat==0 & data1$method==3],
c(1,3,5,7)-0.1,data1$cs_ciu_test[data1$norm==1 & data1$strat==0 & data1$combat==0 & data1$method==3],col="gray",lwd=2,lty=1)
segments(c(1,3,5,7),data1$cs_cil_test[data1$norm==2 & data1$strat==1 & data1$combat==0 & data1$method==3],
c(1,3,5,7),data1$cs_ciu_test[data1$norm==2 & data1$strat==1 & data1$combat==0 & data1$method==3],col="gray",lwd=2,lty=1)
# segments(c(1,3,5,7)+0.1,data1$cs_cil_test[data1$norm==2 & data1$strat==0 & data1$combat==1 & data1$method==3],
#          c(1,3,5,7)+0.1,data1$cs_ciu_test[data1$norm==2 & data1$strat==0 & data1$combat==1 & data1$method==3],col="gray",lwd=2,lty=1)
segments(c(1,3,5,7)+0.2,data1$cs_cil_test[data1$norm==2 & data1$strat==0 & data1$combat==0 & data1$method==3],
c(1,3,5,7)+0.2,data1$cs_ciu_test[data1$norm==2 & data1$strat==0 & data1$combat==0 & data1$method==3],col="gray",lwd=2,lty=1)
segments(c(1,3,5,7)+0.3,data1$cs_cil_test[data1$norm==3 & data1$strat==1 & data1$combat==0 & data1$method==3],
c(1,3,5,7)+0.3,data1$cs_ciu_test[data1$norm==3 & data1$strat==1 & data1$combat==0 & data1$method==3],col="gray",lwd=2,lty=1)
# segments(c(1,3,5,7)+0.4,data1$cs_cil_test[data1$norm==3 & data1$strat==0 & data1$combat==1 & data1$method==3],
#          c(1,3,5,7)+0.4,data1$cs_ciu_test[data1$norm==3 & data1$strat==0 & data1$combat==1 & data1$method==3],col="gray",lwd=2,lty=1)
segments(c(1,3,5,7)+0.5,data1$cs_cil_test[data1$norm==3 & data1$strat==0 & data1$combat==0 & data1$method==3],
c(1,3,5,7)+0.5,data1$cs_ciu_test[data1$norm==3 & data1$strat==0 & data1$combat==0 & data1$method==3],col="gray",lwd=2,lty=1)
segments(c(1,3,5,7)+0.6,data1$cs_cil_test[data1$norm==4 & data1$strat==1 & data1$combat==0 & data1$method==3],
c(1,3,5,7)+0.6,data1$cs_ciu_test[data1$norm==4 & data1$strat==1 & data1$combat==0 & data1$method==3],col="gray",lwd=2,lty=1)
# segments(c(1,3,5,7)+0.7,data1$cs_cil_test[data1$norm==4 & data1$strat==0 & data1$combat==1 & data1$method==3],
#          c(1,3,5,7)+0.7,data1$cs_ciu_test[data1$norm==4 & data1$strat==0 & data1$combat==1 & data1$method==3],col="gray",lwd=2,lty=1)
segments(c(1,3,5,7)+0.8,data1$cs_cil_test[data1$norm==4 & data1$strat==0 & data1$combat==0 & data1$method==3],
c(1,3,5,7)+0.8,data1$cs_ciu_test[data1$norm==4 & data1$strat==0 & data1$combat==0 & data1$method==3],col="gray",lwd=2,lty=1)
points(c(1,3,5,7)-0.4, data1$cs_test[data1$norm==0 & data1$strat==0 & data1$combat==0 & data1$method==3],lty=2,col="black",pch=1,cex=1.5)
points(c(1,3,5,7)-0.6, data1$cs_test[data1$norm==0 & data1$strat==1 & data1$combat==0 & data1$method==3],lty=2,col="black",pch=15,cex=1.5)
# points(c(1,3,5,7)-0.5, data1$cs_test[data1$norm==0 & data1$strat==0 & data1$combat==1 & data1$method==3],lty=2,col="black",pch=17,cex=1.5)
points(c(1,3,5,7)-0.3, data1$cs_test[data1$norm==1 & data1$strat==1 & data1$combat==0 & data1$method==3],lty=2,col="red",pch=15,cex=1.5)
# points(c(1,3,5,7)-0.2, data1$cs_test[data1$norm==1 & data1$strat==0 & data1$combat==1 & data1$method==3],lty=2,col="red",pch=17,cex=1.5)
points(c(1,3,5,7)-0.1, data1$cs_test[data1$norm==1 & data1$strat==0 & data1$combat==0 & data1$method==3],lty=2,col="red",pch=1,cex=1.5)
points(c(1,3,5,7), data1$cs_test[data1$norm==2 & data1$strat==1 & data1$combat==0 & data1$method==3],lty=2,col="green",pch=15,cex=1.5)
# points(c(1,3,5,7)+0.1, data1$cs_test[data1$norm==2 & data1$strat==0 & data1$combat==1 & data1$method==3],lty=2,col="green",pch=17,cex=1.5)
points(c(1,3,5,7)+0.2, data1$cs_test[data1$norm==2 & data1$strat==0 & data1$combat==0 & data1$method==3],lty=2,col="green",pch=1,cex=1.5)
points(c(1,3,5,7)+0.3, data1$cs_test[data1$norm==3 & data1$strat==1 & data1$combat==0 & data1$method==3],lty=2,col="blue",pch=15,cex=1.5)
# points(c(1,3,5,7)+0.4, data1$cs_test[data1$norm==3 & data1$strat==0 & data1$combat==1 & data1$method==3],lty=2,col="blue",pch=17,cex=1.5)
points(c(1,3,5,7)+0.5, data1$cs_test[data1$norm==3 & data1$strat==0 & data1$combat==0 & data1$method==3],lty=2,col="blue",pch=1,cex=1.5)
points(c(1,3,5,7)+0.6, data1$cs_test[data1$norm==4 & data1$strat==1 & data1$combat==0 & data1$method==3],lty=2,col="orange",pch=15,cex=1.5)
# points(c(1,3,5,7)+0.7, data1$cs_test[data1$norm==4 & data1$strat==0 & data1$combat==1 & data1$method==3],lty=2,col="orange",pch=17,cex=1.5)
points(c(1,3,5,7)+0.8, data1$cs_test[data1$norm==4 & data1$strat==0 & data1$combat==0 & data1$method==3],lty=2,col="orange",pch=1,cex=1.5)
axis(2)
axis(1,at=c(1,3,5,7),tick=F, labels=c("BE00Asso00", "BE10Asso00", "BE10Asso10", "BE11Asso00"), cex.axis=1.2)
box()
abline(v=c(2,4,6), lty=2)
abline(h=0.5, lty=2)
plot(c(1,3,5,7)-0.4, data2$cs_test[data2$norm==0 & data2$strat==0 & data2$combat==0 & data2$method==3], type="p",ylim=c(0,1), xlim=c(0,8),
main="Lasso method", ylab="Test C-index",xlab="", col="black", pch=1, axes=F, cex=1.5, cex.lab=1.2,lty=1,cex.main=1.2)
segments(c(1,3,5,7)-0.4,data2$cs_cil_test[data2$norm==0 & data2$strat==0 & data2$combat==0 & data2$method==3],
c(1,3,5,7)-0.4,data2$cs_ciu_test[data2$norm==0 & data2$strat==0 & data2$combat==0 & data2$method==3],col="gray",lwd=2,lty=1)
segments(c(1,3,5,7)-0.6,data2$cs_cil_test[data2$norm==0 & data2$strat==1 & data2$combat==0 & data2$method==3],
c(1,3,5,7)-0.6,data2$cs_ciu_test[data2$norm==0 & data2$strat==1 & data2$combat==0 & data2$method==3],col="gray",lwd=2,lty=1)
segments(c(1,3,5,7)-0.5,data2$cs_cil_test[data2$norm==0 & data2$strat==0 & data2$combat==1 & data2$method==3],
c(1,3,5,7)-0.5,data2$cs_ciu_test[data2$norm==0 & data2$strat==0 & data2$combat==1 & data2$method==3],col="gray",lwd=2,lty=1)
segments(c(1,3,5,7)-0.3,data2$cs_cil_test[data2$norm==1 & data2$strat==1 & data2$combat==0 & data2$method==3],
c(1,3,5,7)-0.3,data2$cs_ciu_test[data2$norm==1 & data2$strat==1 & data2$combat==0 & data2$method==3],col="gray",lwd=2,lty=1)
segments(c(1,3,5,7)-0.2,data2$cs_cil_test[data2$norm==1 & data2$strat==0 & data2$combat==1 & data2$method==3],
c(1,3,5,7)-0.2,data2$cs_ciu_test[data2$norm==1 & data2$strat==0 & data2$combat==1 & data2$method==3],col="gray",lwd=2,lty=1)
segments(c(1,3,5,7)-0.1,data2$cs_cil_test[data2$norm==1 & data2$strat==0 & data2$combat==0 & data2$method==3],
c(1,3,5,7)-0.1,data2$cs_ciu_test[data2$norm==1 & data2$strat==0 & data2$combat==0 & data2$method==3],col="gray",lwd=2,lty=1)
segments(c(1,3,5,7),data2$cs_cil_test[data2$norm==2 & data2$strat==1 & data2$combat==0 & data2$method==3],
c(1,3,5,7),data2$cs_ciu_test[data2$norm==2 & data2$strat==1 & data2$combat==0 & data2$method==3],col="gray",lwd=2,lty=1)
segments(c(1,3,5,7)+0.1,data2$cs_cil_test[data2$norm==2 & data2$strat==0 & data2$combat==1 & data2$method==3],
c(1,3,5,7)+0.1,data2$cs_ciu_test[data2$norm==2 & data2$strat==0 & data2$combat==1 & data2$method==3],col="gray",lwd=2,lty=1)
segments(c(1,3,5,7)+0.2,data2$cs_cil_test[data2$norm==2 & data2$strat==0 & data2$combat==0 & data2$method==3],
c(1,3,5,7)+0.2,data2$cs_ciu_test[data2$norm==2 & data2$strat==0 & data2$combat==0 & data2$method==3],col="gray",lwd=2,lty=1)
segments(c(1,3,5,7)+0.3,data2$cs_cil_test[data2$norm==3 & data2$strat==1 & data2$combat==0 & data2$method==3],
c(1,3,5,7)+0.3,data2$cs_ciu_test[data2$norm==3 & data2$strat==1 & data2$combat==0 & data2$method==3],col="gray",lwd=2,lty=1)
segments(c(1,3,5,7)+0.4,data2$cs_cil_test[data2$norm==3 & data2$strat==0 & data2$combat==1 & data2$method==3],
c(1,3,5,7)+0.4,data2$cs_ciu_test[data2$norm==3 & data2$strat==0 & data2$combat==1 & data2$method==3],col="gray",lwd=2,lty=1)
segments(c(1,3,5,7)+0.5,data2$cs_cil_test[data2$norm==3 & data2$strat==0 & data2$combat==0 & data2$method==3],
c(1,3,5,7)+0.5,data2$cs_ciu_test[data2$norm==3 & data2$strat==0 & data2$combat==0 & data2$method==3],col="gray",lwd=2,lty=1)
segments(c(1,3,5,7)+0.6,data2$cs_cil_test[data2$norm==4 & data2$strat==1 & data2$combat==0 & data2$method==3],
c(1,3,5,7)+0.6,data2$cs_ciu_test[data2$norm==4 & data2$strat==1 & data2$combat==0 & data2$method==3],col="gray",lwd=2,lty=1)
segments(c(1,3,5,7)+0.7,data2$cs_cil_test[data2$norm==4 & data2$strat==0 & data2$combat==1 & data2$method==3],
c(1,3,5,7)+0.7,data2$cs_ciu_test[data2$norm==4 & data2$strat==0 & data2$combat==1 & data2$method==3],col="gray",lwd=2,lty=1)
segments(c(1,3,5,7)+0.8,data2$cs_cil_test[data2$norm==4 & data2$strat==0 & data2$combat==0 & data2$method==3],
c(1,3,5,7)+0.8,data2$cs_ciu_test[data2$norm==4 & data2$strat==0 & data2$combat==0 & data2$method==3],col="gray",lwd=2,lty=1)
points(c(1,3,5,7)-0.4, data2$cs_test[data2$norm==0 & data2$strat==0 & data2$combat==0 & data2$method==3],lty=2,col="black",pch=1,cex=1.5)
points(c(1,3,5,7)-0.6, data2$cs_test[data2$norm==0 & data2$strat==1 & data2$combat==0 & data2$method==3],lty=2,col="black",pch=15,cex=1.5)
points(c(1,3,5,7)-0.5, data2$cs_test[data2$norm==0 & data2$strat==0 & data2$combat==1 & data2$method==3],lty=2,col="black",pch=17,cex=1.5)
points(c(1,3,5,7)-0.3, data2$cs_test[data2$norm==1 & data2$strat==1 & data2$combat==0 & data2$method==3],lty=2,col="red",pch=15,cex=1.5)
points(c(1,3,5,7)-0.2, data2$cs_test[data2$norm==1 & data2$strat==0 & data2$combat==1 & data2$method==3],lty=2,col="red",pch=17,cex=1.5)
points(c(1,3,5,7)-0.1, data2$cs_test[data2$norm==1 & data2$strat==0 & data2$combat==0 & data2$method==3],lty=2,col="red",pch=1,cex=1.5)
points(c(1,3,5,7), data2$cs_test[data2$norm==2 & data2$strat==1 & data2$combat==0 & data2$method==3],lty=2,col="green",pch=15,cex=1.5)
points(c(1,3,5,7)+0.1, data2$cs_test[data2$norm==2 & data2$strat==0 & data2$combat==1 & data2$method==3],lty=2,col="green",pch=17,cex=1.5)
points(c(1,3,5,7)+0.2, data2$cs_test[data2$norm==2 & data2$strat==0 & data2$combat==0 & data2$method==3],lty=2,col="green",pch=1,cex=1.5)
points(c(1,3,5,7)+0.3, data2$cs_test[data2$norm==3 & data2$strat==1 & data2$combat==0 & data2$method==3],lty=2,col="blue",pch=15,cex=1.5)
points(c(1,3,5,7)+0.4, data2$cs_test[data2$norm==3 & data2$strat==0 & data2$combat==1 & data2$method==3],lty=2,col="blue",pch=17,cex=1.5)
points(c(1,3,5,7)+0.5, data2$cs_test[data2$norm==3 & data2$strat==0 & data2$combat==0 & data2$method==3],lty=2,col="blue",pch=1,cex=1.5)
points(c(1,3,5,7)+0.6, data2$cs_test[data2$norm==4 & data2$strat==1 & data2$combat==0 & data2$method==3],lty=2,col="orange",pch=15,cex=1.5)
points(c(1,3,5,7)+0.7, data2$cs_test[data2$norm==4 & data2$strat==0 & data2$combat==1 & data2$method==3],lty=2,col="orange",pch=17,cex=1.5)
points(c(1,3,5,7)+0.8, data2$cs_test[data2$norm==4 & data2$strat==0 & data2$combat==0 & data2$method==3],lty=2,col="orange",pch=1,cex=1.5)
axis(2)
axis(1,at=c(1,3,5,7),tick=F, labels=c("BE11Asso10", "BE11Asso01", "BE11Asso11", "BE11Asso1-1"), cex.axis=1.2)
box()
abline(v=c(2,4,6), lty=2)
abline(h=0.5, lty=2)
legend2("bottomleft",bty="n",lty=1,lwd=2,pch=c(1,15,17,1,1,1), pt.bg="black", col=c(rep("black",each=3), "red","green","blue","orange"),
legend=c("None","X+BatMan","X+ComBat","TC","UQ","TMM","QN"),cex=1.2,
pt.col=c(rep("black",each=3), "red","green","blue","orange"),line.col="grey")
text(1.1,0.1,"black: X=no norm;",pos=4,cex=1.2)
text(2.5,0.1,"red: X=TC;",pos=4,cex=1.2,col="red")
text(3.5,0.1,"green: X=UQ;",pos=4,cex=1.2,col="green")
text(5.0,0.1,"blue: X=TMM",pos=4,cex=1.2,col="blue")
text(6.5,0.1,"blue: X=QN",pos=4,cex=1.2,col="orange")
dev.off()
pdf("edgeRV2meanb_LB_alasso_bs20.pdf", width=14, height=14)
par(mar=c(3.1, 4.1, 2.1, 2.1), las=1)
par(mfrow=c(2,1))
plot(c(1,3,5,7)-0.4, data1$cs_test[data1$norm==0 & data1$strat==0 & data1$combat==0 & data1$method==4], type="p",ylim=c(0,1), xlim=c(0,8),
main="Adaptive Lasso method", ylab="Test C-index",xlab="", col="black", pch=1, axes=F, cex=1.5, cex.lab=1.2,lty=1,cex.main=1.2)
segments(c(1,3,5,7)-0.4,data1$cs_cil_test[data1$norm==0 & data1$strat==0 & data1$combat==0 & data1$method==4],
c(1,3,5,7)-0.4,data1$cs_ciu_test[data1$norm==0 & data1$strat==0 & data1$combat==0 & data1$method==4],col="gray",lwd=2,lty=1)
segments(c(1,3,5,7)-0.6,data1$cs_cil_test[data1$norm==0 & data1$strat==1 & data1$combat==0 & data1$method==4],
c(1,3,5,7)-0.6,data1$cs_ciu_test[data1$norm==0 & data1$strat==1 & data1$combat==0 & data1$method==4],col="gray",lwd=2,lty=1)
# segments(c(1,3,5,7)-0.5,data1$cs_cil_test[data1$norm==0 & data1$strat==0 & data1$combat==1 & data1$method==4],
#          c(1,3,5,7)-0.5,data1$cs_ciu_test[data1$norm==0 & data1$strat==0 & data1$combat==1 & data1$method==4],col="gray",lwd=2,lty=1)
segments(c(1,3,5,7)-0.3,data1$cs_cil_test[data1$norm==1 & data1$strat==1 & data1$combat==0 & data1$method==4],
c(1,3,5,7)-0.3,data1$cs_ciu_test[data1$norm==1 & data1$strat==1 & data1$combat==0 & data1$method==4],col="gray",lwd=2,lty=1)
# segments(c(1,3,5,7)-0.2,data1$cs_cil_test[data1$norm==1 & data1$strat==0 & data1$combat==1 & data1$method==4],
#          c(1,3,5,7)-0.2,data1$cs_ciu_test[data1$norm==1 & data1$strat==0 & data1$combat==1 & data1$method==4],col="gray",lwd=2,lty=1)
segments(c(1,3,5,7)-0.1,data1$cs_cil_test[data1$norm==1 & data1$strat==0 & data1$combat==0 & data1$method==4],
c(1,3,5,7)-0.1,data1$cs_ciu_test[data1$norm==1 & data1$strat==0 & data1$combat==0 & data1$method==4],col="gray",lwd=2,lty=1)
segments(c(1,3,5,7),data1$cs_cil_test[data1$norm==2 & data1$strat==1 & data1$combat==0 & data1$method==4],
c(1,3,5,7),data1$cs_ciu_test[data1$norm==2 & data1$strat==1 & data1$combat==0 & data1$method==4],col="gray",lwd=2,lty=1)
# segments(c(1,3,5,7)+0.1,data1$cs_cil_test[data1$norm==2 & data1$strat==0 & data1$combat==1 & data1$method==4],
#          c(1,3,5,7)+0.1,data1$cs_ciu_test[data1$norm==2 & data1$strat==0 & data1$combat==1 & data1$method==4],col="gray",lwd=2,lty=1)
segments(c(1,3,5,7)+0.2,data1$cs_cil_test[data1$norm==2 & data1$strat==0 & data1$combat==0 & data1$method==4],
c(1,3,5,7)+0.2,data1$cs_ciu_test[data1$norm==2 & data1$strat==0 & data1$combat==0 & data1$method==4],col="gray",lwd=2,lty=1)
segments(c(1,3,5,7)+0.3,data1$cs_cil_test[data1$norm==3 & data1$strat==1 & data1$combat==0 & data1$method==4],
c(1,3,5,7)+0.3,data1$cs_ciu_test[data1$norm==3 & data1$strat==1 & data1$combat==0 & data1$method==4],col="gray",lwd=2,lty=1)
# segments(c(1,3,5,7)+0.4,data1$cs_cil_test[data1$norm==3 & data1$strat==0 & data1$combat==1 & data1$method==4],
#          c(1,3,5,7)+0.4,data1$cs_ciu_test[data1$norm==3 & data1$strat==0 & data1$combat==1 & data1$method==4],col="gray",lwd=2,lty=1)
segments(c(1,3,5,7)+0.5,data1$cs_cil_test[data1$norm==3 & data1$strat==0 & data1$combat==0 & data1$method==4],
c(1,3,5,7)+0.5,data1$cs_ciu_test[data1$norm==3 & data1$strat==0 & data1$combat==0 & data1$method==4],col="gray",lwd=2,lty=1)
segments(c(1,3,5,7)+0.6,data1$cs_cil_test[data1$norm==4 & data1$strat==1 & data1$combat==0 & data1$method==4],
c(1,3,5,7)+0.6,data1$cs_ciu_test[data1$norm==4 & data1$strat==1 & data1$combat==0 & data1$method==4],col="gray",lwd=2,lty=1)
# segments(c(1,3,5,7)+0.7,data1$cs_cil_test[data1$norm==4 & data1$strat==0 & data1$combat==1 & data1$method==4],
#          c(1,3,5,7)+0.7,data1$cs_ciu_test[data1$norm==4 & data1$strat==0 & data1$combat==1 & data1$method==4],col="gray",lwd=2,lty=1)
segments(c(1,3,5,7)+0.8,data1$cs_cil_test[data1$norm==4 & data1$strat==0 & data1$combat==0 & data1$method==4],
c(1,3,5,7)+0.8,data1$cs_ciu_test[data1$norm==4 & data1$strat==0 & data1$combat==0 & data1$method==4],col="gray",lwd=2,lty=1)
points(c(1,3,5,7)-0.4, data1$cs_test[data1$norm==0 & data1$strat==0 & data1$combat==0 & data1$method==4],lty=2,col="black",pch=1,cex=1.5)
points(c(1,3,5,7)-0.6, data1$cs_test[data1$norm==0 & data1$strat==1 & data1$combat==0 & data1$method==4],lty=2,col="black",pch=15,cex=1.5)
# points(c(1,3,5,7)-0.5, data1$cs_test[data1$norm==0 & data1$strat==0 & data1$combat==1 & data1$method==4],lty=2,col="black",pch=17,cex=1.5)
points(c(1,3,5,7)-0.3, data1$cs_test[data1$norm==1 & data1$strat==1 & data1$combat==0 & data1$method==4],lty=2,col="red",pch=15,cex=1.5)
# points(c(1,3,5,7)-0.2, data1$cs_test[data1$norm==1 & data1$strat==0 & data1$combat==1 & data1$method==4],lty=2,col="red",pch=17,cex=1.5)
points(c(1,3,5,7)-0.1, data1$cs_test[data1$norm==1 & data1$strat==0 & data1$combat==0 & data1$method==4],lty=2,col="red",pch=1,cex=1.5)
points(c(1,3,5,7), data1$cs_test[data1$norm==2 & data1$strat==1 & data1$combat==0 & data1$method==4],lty=2,col="green",pch=15,cex=1.5)
# points(c(1,3,5,7)+0.1, data1$cs_test[data1$norm==2 & data1$strat==0 & data1$combat==1 & data1$method==4],lty=2,col="green",pch=17,cex=1.5)
points(c(1,3,5,7)+0.2, data1$cs_test[data1$norm==2 & data1$strat==0 & data1$combat==0 & data1$method==4],lty=2,col="green",pch=1,cex=1.5)
points(c(1,3,5,7)+0.3, data1$cs_test[data1$norm==3 & data1$strat==1 & data1$combat==0 & data1$method==4],lty=2,col="blue",pch=15,cex=1.5)
# points(c(1,3,5,7)+0.4, data1$cs_test[data1$norm==3 & data1$strat==0 & data1$combat==1 & data1$method==4],lty=2,col="blue",pch=17,cex=1.5)
points(c(1,3,5,7)+0.5, data1$cs_test[data1$norm==3 & data1$strat==0 & data1$combat==0 & data1$method==4],lty=2,col="blue",pch=1,cex=1.5)
points(c(1,3,5,7)+0.6, data1$cs_test[data1$norm==4 & data1$strat==1 & data1$combat==0 & data1$method==4],lty=2,col="orange",pch=15,cex=1.5)
# points(c(1,3,5,7)+0.7, data1$cs_test[data1$norm==4 & data1$strat==0 & data1$combat==1 & data1$method==4],lty=2,col="orange",pch=17,cex=1.5)
points(c(1,3,5,7)+0.8, data1$cs_test[data1$norm==4 & data1$strat==0 & data1$combat==0 & data1$method==4],lty=2,col="orange",pch=1,cex=1.5)
axis(2)
axis(1,at=c(1,3,5,7),tick=F, labels=c("BE00Asso00", "BE10Asso00", "BE10Asso10", "BE11Asso00"), cex.axis=1.2)
box()
abline(v=c(2,4,6), lty=2)
abline(h=0.5, lty=2)
plot(c(1,3,5,7)-0.4, data2$cs_test[data2$norm==0 & data2$strat==0 & data2$combat==0 & data2$method==4], type="p",ylim=c(0,1), xlim=c(0,8),
main="Adaptive Lasso method", ylab="Test C-index",xlab="", col="black", pch=1, axes=F, cex=1.5, cex.lab=1.2,lty=1,cex.main=1.2)
segments(c(1,3,5,7)-0.4,data2$cs_cil_test[data2$norm==0 & data2$strat==0 & data2$combat==0 & data2$method==4],
c(1,3,5,7)-0.4,data2$cs_ciu_test[data2$norm==0 & data2$strat==0 & data2$combat==0 & data2$method==4],col="gray",lwd=2,lty=1)
segments(c(1,3,5,7)-0.6,data2$cs_cil_test[data2$norm==0 & data2$strat==1 & data2$combat==0 & data2$method==4],
c(1,3,5,7)-0.6,data2$cs_ciu_test[data2$norm==0 & data2$strat==1 & data2$combat==0 & data2$method==4],col="gray",lwd=2,lty=1)
segments(c(1,3,5,7)-0.5,data2$cs_cil_test[data2$norm==0 & data2$strat==0 & data2$combat==1 & data2$method==4],
c(1,3,5,7)-0.5,data2$cs_ciu_test[data2$norm==0 & data2$strat==0 & data2$combat==1 & data2$method==4],col="gray",lwd=2,lty=1)
segments(c(1,3,5,7)-0.3,data2$cs_cil_test[data2$norm==1 & data2$strat==1 & data2$combat==0 & data2$method==4],
c(1,3,5,7)-0.3,data2$cs_ciu_test[data2$norm==1 & data2$strat==1 & data2$combat==0 & data2$method==4],col="gray",lwd=2,lty=1)
segments(c(1,3,5,7)-0.2,data2$cs_cil_test[data2$norm==1 & data2$strat==0 & data2$combat==1 & data2$method==4],
c(1,3,5,7)-0.2,data2$cs_ciu_test[data2$norm==1 & data2$strat==0 & data2$combat==1 & data2$method==4],col="gray",lwd=2,lty=1)
segments(c(1,3,5,7)-0.1,data2$cs_cil_test[data2$norm==1 & data2$strat==0 & data2$combat==0 & data2$method==4],
c(1,3,5,7)-0.1,data2$cs_ciu_test[data2$norm==1 & data2$strat==0 & data2$combat==0 & data2$method==4],col="gray",lwd=2,lty=1)
segments(c(1,3,5,7),data2$cs_cil_test[data2$norm==2 & data2$strat==1 & data2$combat==0 & data2$method==4],
c(1,3,5,7),data2$cs_ciu_test[data2$norm==2 & data2$strat==1 & data2$combat==0 & data2$method==4],col="gray",lwd=2,lty=1)
segments(c(1,3,5,7)+0.1,data2$cs_cil_test[data2$norm==2 & data2$strat==0 & data2$combat==1 & data2$method==4],
c(1,3,5,7)+0.1,data2$cs_ciu_test[data2$norm==2 & data2$strat==0 & data2$combat==1 & data2$method==4],col="gray",lwd=2,lty=1)
segments(c(1,3,5,7)+0.2,data2$cs_cil_test[data2$norm==2 & data2$strat==0 & data2$combat==0 & data2$method==4],
c(1,3,5,7)+0.2,data2$cs_ciu_test[data2$norm==2 & data2$strat==0 & data2$combat==0 & data2$method==4],col="gray",lwd=2,lty=1)
segments(c(1,3,5,7)+0.3,data2$cs_cil_test[data2$norm==3 & data2$strat==1 & data2$combat==0 & data2$method==4],
c(1,3,5,7)+0.3,data2$cs_ciu_test[data2$norm==3 & data2$strat==1 & data2$combat==0 & data2$method==4],col="gray",lwd=2,lty=1)
segments(c(1,3,5,7)+0.4,data2$cs_cil_test[data2$norm==3 & data2$strat==0 & data2$combat==1 & data2$method==4],
c(1,3,5,7)+0.4,data2$cs_ciu_test[data2$norm==3 & data2$strat==0 & data2$combat==1 & data2$method==4],col="gray",lwd=2,lty=1)
segments(c(1,3,5,7)+0.5,data2$cs_cil_test[data2$norm==3 & data2$strat==0 & data2$combat==0 & data2$method==4],
c(1,3,5,7)+0.5,data2$cs_ciu_test[data2$norm==3 & data2$strat==0 & data2$combat==0 & data2$method==4],col="gray",lwd=2,lty=1)
segments(c(1,3,5,7)+0.6,data2$cs_cil_test[data2$norm==4 & data2$strat==1 & data2$combat==0 & data2$method==4],
c(1,3,5,7)+0.6,data2$cs_ciu_test[data2$norm==4 & data2$strat==1 & data2$combat==0 & data2$method==4],col="gray",lwd=2,lty=1)
segments(c(1,3,5,7)+0.7,data2$cs_cil_test[data2$norm==4 & data2$strat==0 & data2$combat==1 & data2$method==4],
c(1,3,5,7)+0.7,data2$cs_ciu_test[data2$norm==4 & data2$strat==0 & data2$combat==1 & data2$method==4],col="gray",lwd=2,lty=1)
segments(c(1,3,5,7)+0.8,data2$cs_cil_test[data2$norm==4 & data2$strat==0 & data2$combat==0 & data2$method==4],
c(1,3,5,7)+0.8,data2$cs_ciu_test[data2$norm==4 & data2$strat==0 & data2$combat==0 & data2$method==4],col="gray",lwd=2,lty=1)
points(c(1,3,5,7)-0.4, data2$cs_test[data2$norm==0 & data2$strat==0 & data2$combat==0 & data2$method==4],lty=2,col="black",pch=1,cex=1.5)
points(c(1,3,5,7)-0.6, data2$cs_test[data2$norm==0 & data2$strat==1 & data2$combat==0 & data2$method==4],lty=2,col="black",pch=15,cex=1.5)
points(c(1,3,5,7)-0.5, data2$cs_test[data2$norm==0 & data2$strat==0 & data2$combat==1 & data2$method==4],lty=2,col="black",pch=17,cex=1.5)
points(c(1,3,5,7)-0.3, data2$cs_test[data2$norm==1 & data2$strat==1 & data2$combat==0 & data2$method==4],lty=2,col="red",pch=15,cex=1.5)
points(c(1,3,5,7)-0.2, data2$cs_test[data2$norm==1 & data2$strat==0 & data2$combat==1 & data2$method==4],lty=2,col="red",pch=17,cex=1.5)
points(c(1,3,5,7)-0.1, data2$cs_test[data2$norm==1 & data2$strat==0 & data2$combat==0 & data2$method==4],lty=2,col="red",pch=1,cex=1.5)
points(c(1,3,5,7), data2$cs_test[data2$norm==2 & data2$strat==1 & data2$combat==0 & data2$method==4],lty=2,col="green",pch=15,cex=1.5)
points(c(1,3,5,7)+0.1, data2$cs_test[data2$norm==2 & data2$strat==0 & data2$combat==1 & data2$method==4],lty=2,col="green",pch=17,cex=1.5)
points(c(1,3,5,7)+0.2, data2$cs_test[data2$norm==2 & data2$strat==0 & data2$combat==0 & data2$method==4],lty=2,col="green",pch=1,cex=1.5)
points(c(1,3,5,7)+0.3, data2$cs_test[data2$norm==3 & data2$strat==1 & data2$combat==0 & data2$method==4],lty=2,col="blue",pch=15,cex=1.5)
points(c(1,3,5,7)+0.4, data2$cs_test[data2$norm==3 & data2$strat==0 & data2$combat==1 & data2$method==4],lty=2,col="blue",pch=17,cex=1.5)
points(c(1,3,5,7)+0.5, data2$cs_test[data2$norm==3 & data2$strat==0 & data2$combat==0 & data2$method==4],lty=2,col="blue",pch=1,cex=1.5)
points(c(1,3,5,7)+0.6, data2$cs_test[data2$norm==4 & data2$strat==1 & data2$combat==0 & data2$method==4],lty=2,col="orange",pch=15,cex=1.5)
points(c(1,3,5,7)+0.7, data2$cs_test[data2$norm==4 & data2$strat==0 & data2$combat==1 & data2$method==4],lty=2,col="orange",pch=17,cex=1.5)
points(c(1,3,5,7)+0.8, data2$cs_test[data2$norm==4 & data2$strat==0 & data2$combat==0 & data2$method==4],lty=2,col="orange",pch=1,cex=1.5)
axis(2)
axis(1,at=c(1,3,5,7),tick=F, labels=c("BE11Asso10", "BE11Asso01", "BE11Asso11", "BE11Asso1-1"), cex.axis=1.2)
box()
abline(v=c(2,4,6), lty=2)
abline(h=0.5, lty=2)
legend2("bottomleft",bty="n",lty=1,lwd=2,pch=c(1,15,17,1,1,1), pt.bg="black", col=c(rep("black",each=3), "red","green","blue","orange"),
legend=c("None","X+BatMan","X+ComBat","TC","UQ","TMM","QN"),cex=1.2,
pt.col=c(rep("black",each=3), "red","green","blue","orange"),line.col="grey")
text(1.1,0.1,"black: X=no norm;",pos=4,cex=1.2)
text(2.5,0.1,"red: X=TC;",pos=4,cex=1.2,col="red")
text(3.5,0.1,"green: X=UQ;",pos=4,cex=1.2,col="green")
text(5.0,0.1,"blue: X=TMM",pos=4,cex=1.2,col="blue")
text(6.5,0.1,"blue: X=QN",pos=4,cex=1.2,col="orange")
dev.off()
